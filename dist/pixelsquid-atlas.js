!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PixelSquid=e():t.PixelSquid=e()}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){"use strict";var n=function(){this._capabilities={allowInteractivity:!0,canvasAvailable:!1,renderToCanvas:!1,eventListener:!0,jqueryEvents:!1,jqueryAvailable:!1,isRetina:!1,isRetinaCapable:!1,windowDimensions:{width:300,height:300},resolution:"600",format:"jpeg",imagePreferences:[{resolution:"600",format:"jpeg"}],loadingSequence:null,latitudeSubset:null,loadConfigurator:!0,loadingBailouts:[],forceRefreshDuration:0};var t=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),e=navigator.userAgent.toLowerCase().indexOf("crios")>-1||navigator.userAgent.toLowerCase().indexOf("chrome")>-1;this._capabilities.allowInteractivity=!(window.ActiveXObject&&!window.XMLHttpRequest);var i=document.createElement("canvas");this._capabilities.canvasAvailable=!(!i.getContext||!i.getContext("2d")),this._capabilities.eventListener=void 0!==document.addEventListener,this._capabilities.eventListener||(this._capabilities.jqueryEvents="undefined"!=typeof jQuery),this._capabilities.jqueryAvailable="undefined"!=typeof jQuery,this._capabilities.isRetina=window.devicePixelRatio>1,this._capabilities.isRetinaCapable=window.devicePixelRatio>1,this._capabilities.canvasAvailable&&(this._capabilities.renderToCanvas=!0),t&&e&&(this._capabilities.renderToCanvas=!0),this._capabilities.isChromeiOS=t&&e,this._refreshImagePreferences()};n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n.getCapabilities=function(){return n.getInstance()._capabilities},n.mergeCapabilities=function(t){function e(t,e){return t?t||e:t}var i=this.getCapabilities();return i.allowInteractivity=e(t.allowInteractivity,i.allowInteractivity),i.renderToCanvas=e(t.renderToCanvas,i.renderToCanvas),i.isRetina=e(t.isRetina,i.isRetina),i.windowDimensions=e(t.windowDimensions,i.windowDimensions),i.resolution=e(t.resolution,i.resolution),i.format=e(t.format,i.format),i.loadingSequence=e(t.loadingSequence,i.loadingSequence),i.latitudeSubset=e(t.latitudeSubset,i.latitudeSubset),i.loadingBailouts=e(t.loadingBailouts,i.loadingBailouts),i},n.refreshImagePreferences=function(){var t=n.getInstance();return t._refreshImagePreferences(),t._capabilities},n.prototype._refreshImagePreferences=function(){this._capabilities.imagePreferences||(this._capabilities.isRetina?600===this._capabilities.windowDimensions.width?this._capabilities.imagePreferences=[{resolution:"2k",format:"jpeg"},{resolution:"600",format:"jpeg"},{resolution:"300",format:"jpeg"}]:300===this._capabilities.windowDimensions.width&&(this._capabilities.imagePreferences=[{resolution:"600",format:"jpeg"},{resolution:"300",format:"jpeg"},{resolution:"2k",format:"jpeg"}]):600===this._capabilities.windowDimensions.width?this._capabilities.imagePreferences=[{resolution:"600",format:"jpeg"},{resolution:"300",format:"jpeg"},{resolution:"2k",format:"jpeg"}]:300===this._capabilities.windowDimensions.width&&(this._capabilities.imagePreferences=[{resolution:"300",format:"jpeg"},{resolution:"600",format:"jpeg"},{resolution:"2k",format:"jpeg"}]))},e.AtlasClientCapabilities=n},function(t,e,i){"use strict";i.r(e),i.d(e,"AtlasSpriteSheetPlayer",(function(){return n})),i.d(e,"AtlasAPIAdapter",(function(){return s})),i.d(e,"AtlasSPAdapter",(function(){return o}));var n=i(2).AtlasSpriteSheetPlayer,s=i(7).AtlasAPIAdapter,o=i(8).AtlasSPAdapter},function(t,e,i){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var s=i(3).AtlasControlAdapter,o=i(4).AtlasSphere,a=i(5).AtlasSpriteSheetControls,l=i(6).AtlasImageWithProgress;function r(t){function e(e,i){return e in t?t[e]:i}this.VERSION="2.9.2",this.VALID_LATITUDES=["B","C","D","E","F","G","H","I","J","K","L","M","N","O"],this.VALID_LONGITUDES=["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16"],this._transport=t.transport,this._elemControlArea=e("controlArea",".atlas-control-area"),this._elemViewer=e("viewer",".atlas-viewer"),this._elemEvents=e("events",".atlas-events"),this._windowSize=e("windowSize",600),this._forceBackground=e("forceBackground",!1),this._preferredImageSize=e("preferredImageSize",600),this._elemParent=e("parent",".atlas-events"),this._useCanvas=e("useCanvas",!0),this._useCanvasTranslation=e("useCanvasTranslation",!0),this._useImageSmoothing=e("useImageSmoothing",!1),this._$=t.jquery,this._applyStyles=e("applyStyles",!1),this._atlasControlAdapter=new s(t.jquery),this._atlasControls=new a(this._elemParent,this._elemControlArea,this._atlasControlAdapter,t.jquery),this._canvas=null,this._context=null,this._div=null,this._url=null,this._imageResolution=0,this._canvasResolution=0,this._loadComplete=!1,this._cssBackgroundSet=!1,this._loadingFallback=null;var i=this;this._$?this._$(this._elemControlArea).on("change",(function(t,e){i._onControlAreaChange(t,e)})):this.addEventListener(this._elemControlArea,"change",(function(t){var e={horizontal:t.horizontal,vertical:t.vertical};void 0!==t.detail&&(e.horizontal=t.detail.horizontal,e.vertical=t.detail.vertical),i._onControlAreaChange(t,e)}),!1)}r.prototype._onControlAreaChange=function(t,e){var i,n;void 0!==t.originalEvent&&(i=t.originalEvent.horizontal,n=t.originalEvent.vertical),void 0!==e&&(i=e.horizontal,n=e.vertical),i=i||t.horizontal||0,n=n||t.vertical||0,this.rotate(i,n)},r.prototype.addEventListener=function(t,e,i){var n=document.querySelectorAll(t);n&&n.length&&n[0].addEventListener(e,i,!1)},r.prototype.triggerEvent=function(t,e,i){if(this._$)this._$(t).trigger(e,[i]);else{var n=document.querySelectorAll(t);if(n&&n.length){if("undefined"!=typeof CustomEvent)return void n[0].dispatchEvent(new CustomEvent(e,{detail:i}));var s;if(void 0!==document.createEvent)return(s=document.createEvent("Event")).initEvent(e,!0,!0),s.detail=i,void n[0].dispatchEvent(s);if("undefined"!=typeof Event)return(s=new Event(e)).detail=i,void n[0].dispatchEvent(s)}}},r.prototype._getDomElement=function(t){var e=t;return"object"!==n(e)?(e=document.querySelectorAll(t))&&e.length?e[0]:null:e},r.prototype.resizeElement=function(t,e,i){var n=this._getDomElement(t);n&&(n.setAttribute("width",e),n.setAttribute("height",e),this._applyStyles&&(n.style.width=[i,"px"].join(""),n.style.height=[i,"px"].join("")))},r.prototype.positionElement=function(t,e,i){var n=this._getDomElement(t);n&&this._applyStyles&&(n.style.position="absolute",n.style.top=[i,"px"].join(""),n.style.left=[e,"px"].join(""))},r.prototype.hide=function(t){var e=this._getDomElement(t);e&&(e.style.display="none")},r.prototype.show=function(t){var e=this._getDomElement(t);e&&(e.style.display="block")},r.prototype.append=function(t,e){var i=this._getDomElement(t),n=this._getDomElement(e);i&&n&&i.appendChild(n)},r.prototype.remove=function(t,e){var i=this._getDomElement(t),n=this._getDomElement(e);i&&n&&i.removeChild(n)};r.prototype.renderCssCell=function(t){var e=this._getDomElement(this._div);e&&(this._applyStyles&&(e.style.width=this._windowSize,e.style.height=this._windowSize),this._cssBackgroundSet||(e.style["background-image"]=['url("',this._url,'")'].join(""),e.style["background-repeat"]="no-repeat",e.style["background-size"]=[16*this._imageResolution*this._backgroundScale,"px ",this._latitudesForSize*this._imageResolution*this._backgroundScale,"px"].join(""),this._cssBackgroundSet=!0),e.style["background-position"]=["-",t.left*this._backgroundScale,"px -",t.top*this._backgroundScale,"px"].join(""))},r.prototype.adjustValidLatitudes=function(t){"top_half"!==t&&"half_spinner"!==t||(this._validLatitudes=["B","C","D","E","F","G","H","I"])},r.prototype.rotate=function(t,e){if(this._currentImage){var i=this._currentImage.substring(0,1),n=this._currentImage.substring(1),s=this._validLatitudes.indexOf(i),o=this._validLongitudes.indexOf(n);s+=e,o+=t%this._atlasSphere._longitudes,s<0?s=0:s>=this._atlasSphere._latitudes&&(s=this._atlasSphere._latitudes-1),o<0?o+=this._atlasSphere._longitudes:o>=this._atlasSphere._longitudes&&(o-=this._atlasSphere._longitudes);var a=this._validLatitudes[s]+this._validLongitudes[o];this.triggerEvent(this._elemEvents,"atlas-image-changed",{currentImage:this._currentImage,nextImage:a}),this.setNextImageIndex(a)}},r.prototype.setNextImageIndex=function(t){this._currentImage=t,this.renderImage()},r.prototype.createCanvas=function(){if(!this._useCanvas)return!1;try{if(this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d"),!this._canvas||!this._context)throw"CANVAS IS NOT SUPPORTED"}catch(t){return this._canvas=null,this._context=null,!1}var t=(window.devicePixelRatio||1)/(this._context.webkitBackingStorePixelRatio||this._context.mozBackingStorePixelRatio||this._context.msBackingStorePixelRatio||this._context.oBackingStorePixelRatio||this._context.backingStorePixelRatio||1);return this._canvasResolution=t*this._windowSize,this.resizeElement(this._canvas,this._canvasResolution,this._windowSize),this.positionElement(this._canvas,0,0),this.hide(this._canvas),this.append(this._elemViewer,this._canvas),!0},r.prototype.createDiv=function(){this._div=document.createElement("div"),this.resizeElement(this._div,this._windowSize,this._windowSize),this.positionElement(this._div,0,0),this.hide(this._div),this.append(this._elemViewer,this._div)},r.prototype.load=function(t,e){if(this._assetId=null,this._asset=null,this._initialImage=null,this._currentImage=null,this._validLatitudes=null,this._latitudesForSize=0,this._validLongitudes=null,this._imageResolution=null,this._loadComplete=!1,this._url=null,this._cssBackgroundSet=!1,this._atlasSphere=new o,"undefined"!=typeof console&&console.log("v"+this.VERSION),!t.asset)throw"NO ASSET SPECIFIED";if(!t.asset.sprites_600&&!t.asset.sprites_300)throw"ASSET NOT A SPRITE SHEET ASSET";this._localUrl=t.localUrl,this._assetId=t.assetId,this._asset=t.asset,this._initialImage=t.initialImage||t.asset.initial_image||"H01",this._currentImage=this._initialImage,this._validLatitudes=this._asset.validLatitudes||this.VALID_LATITUDES,this._validLongitudes=this._asset.validLongitudes||this.VALID_LONGITUDES,this.adjustValidLatitudes(this._asset.extensions.atlas.camera_type_code||this._asset.atlas.camera_type_code),this._latitudesForSize=16;var i="sprites_"+this._preferredImageSize;this._asset[i]&&(this._imageResolution=this._preferredImageSize,this._url=this._asset[i]),this._url||(this._imageResolution=600,this._url=this._asset.sprites_600,this._url||(this._imageResolution=300,this._url=this._asset.sprites_300)),this._backgroundScale=1,this._backgroundScale=this._windowSize/this._imageResolution,this._forceBackground?this.createDiv():this.createCanvas()||this.createDiv(),this._atlasSphere.initPartial(this._validLatitudes,this._validLongitudes,!1,this._imageResolution),this.triggerEvent(this._elemEvents,"atlas-load-start");var n=t.attachImage?this._elemEvents:null;this._atlasImage=new l(n,this._transport);var s=this;this._localUrl?this._atlasImage.loadLocal(this._localUrl,(function(t,i,n,o){o&&(s._latitudesForSize=o.height/s._imageResolution),s.loadCallback(t,i,n,e)})):this._atlasImage.load(this._url,(function(t,i,n,o){o&&(s._latitudesForSize=o.height/s._imageResolution),s.loadCallback(t,i,n,e)}))},r.prototype.loadCallback=function(t,e,i,n){if(t&&(this.triggerEvent(this._elemEvents,"atlas-load-error",{error:t}),n(t,null)),!i&&e<100&&this.triggerEvent(this._elemEvents,"atlas-load-progress",{progress:e/100}),!i&&e>=100){var s=this;this._loadingFallback=setTimeout((function(){s.triggerLoadComplete({},n)}),2e3)}i&&e>=100&&(this._loadingFallback&&(clearTimeout(this._loadingFallback),this._loadingFallback=null),this.triggerLoadComplete(i,n))},r.prototype.triggerLoadComplete=function(t,e){this._loadComplete=!0,this.renderImage(),this._canvas&&this._context?this.show(this._canvas):this.show(this._div),e&&e(null,t),this.triggerEvent(this._elemEvents,"atlas-load-interactivity"),this.triggerEvent(this._elemEvents,"atlas-load-complete",{image:t})},r.prototype.unload=function(){this._atlasControls&&this._atlasControls.unload(),this._atlasImage&&this._atlasImage.unload(),this.remove(this._elemViewer,this._div)},r.prototype.cancelLoading=function(){this._atlasImage&&this._atlasImage.cancel()},r.prototype.renderImage=function(t,e){if(this._loadComplete){this._currentImage=t||this._currentImage;var i=this._atlasSphere.getSphereCellForIndex(this._currentImage);if(this._canvas&&this._context&&!e&&!this._forceBackground)if(this._useImageSmoothing?(this._context.imageSmoothingEnabled=!0,this._context.mozImageSmoothingEnabled=!0):(this._context.imageSmoothingEnabled=!1,this._context.mozImageSmoothingEnabled=!1),this._useCanvasTranslation){this._context.save();var n=this._canvasResolution/this._imageResolution;this._context.scale(n,n),this._context.translate(-i.left,-i.top),this._context.drawImage(this._atlasImage.image,0,0),this._context.restore()}else this._context.drawImage(this._atlasImage.image,i.left,i.top,this._imageResolution,this._imageResolution,0,0,this._canvasResolution,this._canvasResolution);else this.renderCssCell(i)}},r.prototype.getCurrentImageIndex=function(){return this._currentImage},r.prototype.isCanvasRender=function(){return this._canvas&&this._context},r.prototype.resizeWindow=function(t){this._windowSize=t,this._backgroundScale=this._windowSize/this._imageResolution;var e=(window.devicePixelRatio||1)/(this._context.webkitBackingStorePixelRatio||this._context.mozBackingStorePixelRatio||this._context.msBackingStorePixelRatio||this._context.oBackingStorePixelRatio||this._context.backingStorePixelRatio||1);this._canvasResolution=e*this._windowSize,this.isCanvasRender()?this.resizeElement(this._canvas,this._canvasResolution,this._windowSize):this.resizeElement(this._div,this._windowSize,this._windowSize),this.renderImage(this._currentImage,!1)},e.AtlasSpriteSheetPlayer=r},function(t,e,i){"use strict";var n=i(0).AtlasClientCapabilities;e.AtlasControlAdapter=function(t){this._dragging=!1,this._domElement=null,this._cellWidthInPixels=10,this._cellHeightInPixels=10,this._$=t,n.getCapabilities().isRetinaCapable&&(this._cellWidthInPixels/=2,this._cellHeightInPixels/=2),this._changeEvent={type:"change"},this._mouseDown={x:-1,y:-1},this._positionInCell={x:this._cellWidthInPixels/2,y:this._cellHeightInPixels/2},this._nextPositionInCell={x:0,y:0},this.reset=function(){this._positionInCell.x=this._cellWidthInPixels/2,this._positionInCell.y=this._cellHeightInPixels/2},this.begin=function(t,e){this._dragging=!0,this._mouseDown.x=t,this._mouseDown.y=e},this.end=function(t,e){if(this._dragging){this._dragging=!1;var i=t-this._mouseDown.x,n=e-this._mouseDown.y;this._nextPositionInCell.x=this._positionInCell.x+i,this._nextPositionInCell.y=this._positionInCell.y+n;var s=0;this._nextPositionInCell.x>this._cellWidthInPixels?(s=Math.floor(this._nextPositionInCell.x/this._cellWidthInPixels),this._positionInCell.x=this._nextPositionInCell.x-s*this._cellWidthInPixels):this._nextPositionInCell.x<0?(s=-1+Math.ceil(this._nextPositionInCell.x/this._cellWidthInPixels),this._positionInCell.x=this._cellWidthInPixels+this._nextPositionInCell.x%this._cellWidthInPixels):this._positionInCell.x=this._nextPositionInCell.x,s*=-1;var o=0;if(this._nextPositionInCell.y>this._cellHeightInPixels?(o=-1,this._positionInCell.y=this._nextPositionInCell.y-this._cellHeightInPixels):this._nextPositionInCell.y<0?(o=1,this._positionInCell.y=this._cellHeightInPixels+this._nextPositionInCell.y):this._positionInCell.y=this._nextPositionInCell.y,this._domElement&&(Math.abs(s)>0||Math.abs(o)>0))if(this._$)this._$(this._domElement).trigger(this._changeEvent.type,[{horizontal:s,vertical:o}]);else{if("undefined"!=typeof CustomEvent)return void this._domElement.dispatchEvent(new CustomEvent(this._changeEvent.type,{detail:{horizontal:s,vertical:o}}));if(void 0!==document.createEvent){var a=document.createEvent("Event");return a.initEvent(this._changeEvent.type,!0,!0),a.horizontal=s,a.vertical=o,void this._domElement.dispatchEvent(a)}if("undefined"!=typeof Event){var l=new Event(this._changeEvent.type);return l.horizontal=s,l.vertical=o,void this._domElement.dispatchEvent(l)}}}}}},function(t,e,i){"use strict";var n=function(){this._latitudes=0,this._availableLatitudes=[],this._longitudes=0,this._availableLongitudes=[],this._replicatePoles=!1,this._cellResolution=0,this._matrix=[],this._faceMap={}};n.prototype.init=function(t,e,i,n){this._latitudes=t,this._longitudes=e,16===this._latitudes&&16===this._longitudes&&(this._availableLatitudes=Constants.latitudeMarkers.slice(0,this._latitudes),this._availableLongitudes=Constants.longitudeMarkers.slice(0,this._longitudes),this._replicatePoles=i,this._cellResolution=n||0,this._constructSphere(i))},n.prototype.initPartial=function(t,e,i,n){this._availableLatitudes=t.slice(0),this._latitudes=t.length,this._availableLongitudes=e.slice(0),this._longitudes=e.length,this._replicatePoles=i,this._cellResolution=n||0,this._constructSphere(i)},n.prototype.getUniqueSphereCellCount=function(){return(this._replicatePoles?this._latitudes-2:this._latitudes)*this._longitudes},n.prototype.getSphereCellForIndex=function(t){var e=this._faceMap[t];return this.getSphereCellForFace(e)},n.prototype.getSphereCellForLatLon=function(t,e){return t<this._matrix.length&&e<this._matrix[t].length?this._matrix[t][e]:null},n.prototype.getSphereCellForFace=function(t){var e=Math.floor(t/this._longitudes),i=t%this._longitudes;return this.getSphereCellForLatLon(e,i)},n.prototype.getSphereCellCount=function(){return this._latitudes*this._longitudes},n.prototype.mapImageIndexToImageIndex=function(t,e){this.getSphereCellForIndex(t).imageIndex=e},n.prototype.mapFaceToImageIndex=function(t,e){this.getSphereCellForFace(t).imageIndex=e},n.prototype.getMappedImageIndex=function(t){return this.getSphereCellForIndex(t).imageIndex},n.prototype._constructSphere=function(t){for(var e=0,i=0;i<this._availableLatitudes.length;++i){for(var n=[],s=0,o=0;o<this._availableLongitudes.length;++o){var a=this._availableLatitudes[i]+this._availableLongitudes[o],l=a;16===this._availableLatitudes.length&&16===this._availableLongitudes.length&&(t&&0===i?(a=Constants.latitudeMarkers[i+1]+Constants.longitudeMarkers[o],s=0):t&&i===this._latitudes-1&&(a=Constants.latitudeMarkers[i-1]+Constants.longitudeMarkers[o],s=0)),n.push({face:i*this._longitudes+o,isPole:0===i||i===this._latitudes-1,latitude:i,longitude:o,originalImageIndex:l,imageIndex:a,left:s,top:e,right:s+this._cellResolution,bottom:e+this._cellResolution}),this._faceMap[l]=i*this._longitudes+o,s+=this._cellResolution}this._matrix.push(n),e+=this._cellResolution}},e.AtlasSphere=n},function(t,e,i){"use strict";i(0).AtlasClientCapabilities;e.AtlasSpriteSheetControls=function(t,e,i,n){this._$=n,this._parentSelector=t,this._domSelector=e,this._$?this._domElement=this._$(this._domSelector)[0]:this._domElement=document.querySelectorAll(this._domSelector)[0],this._controlAdapter=i,this._windowHalfX=300,this._windowHalfY=300,this._dragEvent={type:"canvasDrag",dragStart:"beforeDrag",dragging:"dragging",dragEnd:"finishDrag"},this._enabled=!1,this._draggin=!1;var s=this,o=window.navigator.msPointerEnabled?"MSPointerDown":"touchstart",a=window.navigator.msPointerEnabled?"MSPointerMove":"touchmove",l=window.navigator.msPointerEnabled?"MSPointerUp":"touchend";o=window.navigator.pointerEnabled?"pointerdown":o,a=window.navigator.pointerEnabled?"pointermove":a,l=window.navigator.pointerEnabled?"pointerup":l;function r(t){return s._windowHalfX=s._domElement.clientWidth/2,s._windowHalfY=s._domElement.clientHeight/2,t.preventDefault(),t.stopPropagation(),!(s._onBeforeMouseDown&&!s._onBeforeMouseDown(t.clientX,t.clientY))&&(!!s._enabled&&(s._dragging=!0,s._controlAdapter.begin(t.clientX,t.clientY),!1))}function h(t){return s._windowHalfX=s._domElement.clientWidth/2,s._windowHalfY=s._domElement.clientHeight/2,t.preventDefault(),t.stopPropagation(),!!s._enabled&&(s._onBeforeMouseUp&&!s._onBeforeMouseUp(t.clientX,t.clientY)||(s._dragging=!1,s.reset()),!1)}function c(t){return!s._dragging||(t.preventDefault(),t.stopPropagation(),!!s._enabled&&(s._onBeforeMouseMove&&!s._onBeforeMouseMove(t.clientX,t.clientY)||(s._controlAdapter.end(t.clientX,t.clientY),s._controlAdapter.begin(t.clientX,t.clientY)),!1))}function u(t){return t||(t=window.event),t.preventDefault(),t.stopPropagation(),!!s._enabled&&(s._onBeforeMouseOut&&!s._onBeforeMouseOut(t.clientX,t.clientY)||(s._dragging=!1,s.reset()),!1)}function _(t){t.preventDefault(),t.stopPropagation();var e=t.originalEvent||t;if(!e.changedTouches&&e.touches&&(e.changedTouches=e.touches),e.changedTouches&&1===e.changedTouches.length||!e.changedTouches){var i=e.touches?e.touches[0].pageX:e.screenX,n=e.touches?e.touches[0].pageY:e.screenY;if(!s._enabled)return!1;var o=i-s._windowHalfX,a=n-s._windowHalfY;if(s._onBeforeTouchDown&&!s._onBeforeTouchDown(o,a))return!1;s._dragging=!0,s._controlAdapter.begin(o,a)}return!1}function d(t){if(!s._dragging)return!0;t.preventDefault(),t.stopPropagation();var e=t.originalEvent||t;if(!e.changedTouches&&e.touches&&(e.changedTouches=e.touches),e.changedTouches&&1===e.changedTouches.length||!e.changedTouches){var i=e.changedTouches?e.changedTouches[0].pageX:e.screenX,n=e.changedTouches?e.changedTouches[0].pageY:e.screenY;if(!s._enabled)return!1;var o=i-s._windowHalfX,a=n-s._windowHalfY;if(s._onBeforeTouchMove&&!s._onBeforeTouchMove(o,a))return!1;s._controlAdapter.end(o,a),s._controlAdapter.begin(o,a)}return!1}function g(t){t.preventDefault(),t.stopPropagation();var e=t.originalEvent||t;if(!e.changedTouches&&e.touches&&(e.changedTouches=e.touches),e.changedTouches&&1===e.changedTouches.length||!e.changedTouches){var i=e.changedTouches?e.changedTouches[0].pageX:e.screenX,n=e.changedTouches?e.changedTouches[0].pageY:e.screenY;if(!s._enabled)return!1;var o=i-s._windowHalfX,a=n-s._windowHalfY;if(s._onBeforeTouchEnd&&!s._onBeforeTouchEnd(o,a))return!1;s._dragging=!1,s.reset()}return!1}this._initialize=function(){this._enabled&&this.unload(),this._controlAdapter&&(this._controlAdapter._domElement=this._domElement),void 0!==this._domElement.style.msTouchAction&&(this._domElement.style.msTouchAction="none"),this._windowHalfX=this._domElement.clientWidth/2,this._windowHalfY=this._domElement.clientHeight/2,this._$?(this._$(this._parentSelector).on("contextmenu.player",this._domSelector,(function(t){t.preventDefault()})),this._$(this._parentSelector).on(o+".player",this._domSelector,_),this._$(this._parentSelector).on("mousedown.player",this._domSelector,r),this._$(this._parentSelector).on("mouseup.player",this._domSelector,h),this._$(this._parentSelector).on("mousemove.player",this._domSelector,c),this._$(this._parentSelector).on("mouseout.player",this._domSelector,u),this._$(this._parentSelector).on(a+".player",this._domSelector,d),this._$(this._parentSelector).on(l+".player",this._domSelector,g)):(this._domElement.addEventListener("contextmenu",(function(t){t.preventDefault()})),this._domElement.addEventListener(o,_),this._domElement.addEventListener("mousedown",r),this._domElement.addEventListener("mouseup",h),this._domElement.addEventListener("mousemove",c),this._domElement.addEventListener("mouseout",u),this._domElement.addEventListener(a,d),this._domElement.addEventListener(l,g)),this._enabled=!0},this.unload=function(){this._$?(this._$(this._parentSelector).off(o+".player",this._domSelector,_),this._$(this._parentSelector).off("mousedown.player",this._domSelector,r),this._$(this._parentSelector).off("mouseup.player",this._domSelector,h),this._$(this._parentSelector).off("mousemove.player",this._domSelector,c),this._$(this._parentSelector).off("mouseout.player",this._domSelector,u),this._$(this._parentSelector).off(a+".player",this._domSelector,d),this._$(this._parentSelector).off(l+".player",this._domSelector,g)):(this._domElement.removeEventListener(o,_),this._domElement.removeEventListener("mousedown",r),this._domElement.removeEventListener("mouseup",h),this._domElement.removeEventListener("mousemove",c),this._domElement.removeEventListener("mouseout",u),this._domElement.removeEventListener(a,d),this._domElement.removeEventListener(l,g))},this.reset=function(){this._controlAdapter&&this._controlAdapter.reset()},this.disable=function(){this._enabled=!1},this.enable=function(){this._enabled=!0},this.setOnBeforeMouseMove=function(t){this._onBeforeMouseMove=t},this.setOnBeforeTouchMove=function(t){this._onBeforeTouchMove=t},this.setOnBeforeMouseDown=function(t){this._onBeforeMouseDown=t},this.setOnBeforeTouchDown=function(t){this._onBeforeTouchDown=t},this.setOnBeforeMouseUp=function(t){this._onBeforeMouseUp=t},this.setOnBeforeTouchEnd=function(t){this._onBeforeTouchEnd=t},this.setOnBeforeMouseOut=function(t){this._onBeforeMouseOut=t},this.clickDrag=function(t,e){this._controlAdapter.end(t,e),this._controlAdapter.begin(t,e)},this._initialize()}},function(t,e,i){"use strict";var n=function(t,e){if(this.transport=e,this.percentComplete=0,this.image=new Image,this.parentElement=null,t){var i=document.querySelectorAll(t);i&&i.length&&(this.parentElement=i[0],this.image.style.width=0,this.image.style.height=0,this.parentElement.appendChild(this.image))}this.cancelled=!1};n.prototype.unload=function(){this.image=null},n.prototype.loadLocal=function(t,e){e&&e(null,0,null);var i=this;this.image.onload=function(){try{if(window.URL.revokeObjectURL(t),i.parentElement&&i.parentElement.removeChild(i.image),e){var n={width:i.image.width||i.image.naturalWidth,height:i.image.height||i.image.naturalHeight};e(null,100,i.image,n)}}catch(t){e(t,0,null,null)}},this.image.onerror=function(){e&&e("error loading local atlas image",null,null)},this.image.src=t},n.prototype.load=function(t,e,i){this.cancelled=!1;var n=this.transport||new XMLHttpRequest;if("onprogress"in n&&!i){this.percentComplete=0,n.open("GET",t,!0),n.responseType="arraybuffer";var s=this;n.onload=function(t){try{var i=n.getAllResponseHeaders().match(/^Content-Type\:\s*(.*?)$/im)[1]||"image/png",o=new Blob([n.response],{type:i}),a=window.URL.createObjectURL(o);s.image.onload=function(){try{if(window.URL.revokeObjectURL(a),s.parentElement&&s.parentElement.removeChild(s.image),e){var t={width:s.image.width||s.image.naturalWidth,height:s.image.height||s.image.naturalHeight};e(null,100,s.image,t)}}catch(t){console.log(t)}},s.image.onerror=function(){e&&e("error loading atlas image",null,null)},s.image.src=a}catch(t){console.log(t)}},n.onprogress=function(t){if(s.cancelled)try{n.abort()}catch(t){}t.lengthComputable&&(s.percentComplete=t.loaded/t.total*100),s.percentComplete<100&&e(null,s.percentComplete,null)},n.onloadstart=function(){s.percentComplete=0,e(null,s.percentComplete,null)},n.onloadend=function(){s.percentComplete=100},n.send()}else{s=this;this.image.onload=function(){e(null,100,s.image)},this.image.src=t}},n.prototype.cancel=function(){this.cancelled=!0},e.AtlasImageWithProgress=n},function(t,e){function i(){this._asset={}}i.prototype.parseResponse=function(t){if(this._asset.productId=t.data.id,this._asset.name=t.data.attributes.name,this._asset.signature_image=t.data.attributes.search_preview_url,this._asset.signature_image){var e=this._asset.signature_image.match(/600\/([^\/]*)\.jpg/);e&&(this._asset.initial_image=e[1])}var i=t.data.attributes;return t.included&&(i=t.included[0].attributes),this._asset.sprites_300=i.sprites_300_url,this._asset.sprites_600=i.sprites_600_url,this._asset.extensions={atlas:{camera_type_code:i.camera_type_code}},this._asset.atlas={camera_type_code:i.camera_type_code},!0},i.prototype.getAsset=function(){return this._asset},e.AtlasAPIAdapter=i},function(t,e){function i(){this._asset={}}i.prototype.parseResponse=function(t){return this._asset.productId=t.data.id,this._asset.name=t.data.name,this._asset.extensions=t.data.extensions,this._asset.atlas=t.data.atlas,this._asset.initial_image=t.data.initial_image,this._asset.signature_image=t.data.signature_image,this._asset.sprites_600=t.data.sprites_600,this._asset.sprites_300=t.data.sprites_300,!0},i.prototype.getAsset=function(){return this._asset},e.AtlasSPAdapter=i}])}));